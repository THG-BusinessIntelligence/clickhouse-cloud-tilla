-- Materialized View: Order_Header
-- Refreshes every 5 minutes
CREATE OR REPLACE MATERIALIZED VIEW Order_Header
OPTIONS(
    enable_refresh = true,
    refresh_interval_minutes = 5
)
AS
SELECT
    Order_Number,
    Site,
    Catalogue_Site,
    Site_Name,
    Order_Created,
    Source_System,
    Customer_Id,  
    Locale,
    Order_Status_Id,
    Order_Status,
    Order_Type_Id,
    Order_Type,
    Order_Qty,
    Order_Net_Qty,
    Order_Cancelled_Qty,
    Order_Refunded_Qty,
    Order_Replaced_Qty,
    Order_Returned_Qty,
    Order_Dispatched_Qty,
    Order_Outstanding_Qty,
    Order_Free_Gift_Qty,
    Order_Final_Qty,
    Order_Total_Value,
    Order_Shipping_Charge,
    Order_Shipping_Discount,
    Order_Product_Value,
    Order_Funding,
    Order_Tax,
    Order_Shipping_Tax,
    Order_GP,
    Order_List_Price,
    Order_Discount,
    Order_RRP,
    Order_MarkDown,
    Order_Cost,
    Credit_Used,
    Currency_Code,
    Exchange_Rate_To_GBP,
    Order_Sequence,
    Offer_Id,
    Discount_Code,
    Payment_Method,
    Payment_Status_Id,
    Payment_Status,
    External_Order_Number,
    Dispatched_Date,
    Expected_Dispatched_Date,
    Order_Reference,
    Guest,
    Affiliate_Refer,
    Sub_Payment_Type,
    Subscription_Id,
    Source_GA,
    Medium_GA,
    Campaign_GA,
    Channel_GA,
    Source_Ely,
    Medium_Ely,
    Campaign_Ely,
    Affil_Parameter_Ely,
    Channel_Ely,
    DeviceCategory,
    Platform_Version,
    Platform,
    Country_Code_Billing,  
    Country_Billing,       
    Country_Code_Shipping,  
    Country_Shipping,       
    Updated_Date,
    Loaded_Date
FROM `thg-prod-cloud-dw.CloudDWConsolidated.Order_Header`
WHERE Site IN (46, 37)
